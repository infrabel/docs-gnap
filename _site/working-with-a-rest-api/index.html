<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Working with a REST API</title>
    <meta name="description" content="The official GNaP documentation">
    <link rel="canonical" href="http://gnap-web-themes-docs.azurewebsites.net/working-with-a-rest-api/">
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <a href="https://github.com/infrabel/GNaP.Web.Themes"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <div class="list-group">
      <a href="/" class="list-group-item ">Getting Started</a>
      <a href="/application-structure" class="list-group-item ">Application structure</a>
      <a href="/configuring-your-application" class="list-group-item ">Configuring your application</a>
      <a href="/states-controllers-views" class="list-group-item ">States, controllers &amp; views</a>
      <a href="/working-with-a-rest-api" class="list-group-item active">Working with a REST API</a>
      <a href="/authenticating-using-a-jwt-token" class="list-group-item ">Authenticating using a JWT token</a>
      <a href="/internationalization" class="list-group-item ">Internationalization (I18n)</a>
      <a href="/validating-user-input" class="list-group-item ">Validating user input</a>
      <a href="/error-handling" class="list-group-item ">Error handling</a>
      <a href="/putting-your-application-in-production" class="list-group-item ">Putting your application in production</a>
      <a href="/troubleshooting-your-application" class="list-group-item ">Troubleshooting your application</a>
      <a href="/advanced-topics" class="list-group-item ">Advanced topics</a>
      <a href="/appendix-1-sample-node-rest-api" class="list-group-item ">Appendix 1: Sample node REST API</a>
</div>
        </div>
        <div class="col-md-8 col-md-offset-1 ">
          <div class="article">

  <header class="article-header">
    <h1>Working with a REST API</h1>
  </header>

  <article class="article-content">
  <h2 id="about-rest">About REST</h2>

<p>Together with the rise of web 2.0 applications exposing an API came the trend of creating mashups for all kind of popular services. This fueled the demand for simple web APIs to replace the heavy ceremony-laden SOAP web services. In 2000 the term <em>representational state transfer</em> was introduced and developers quickly jumped on the bandwagon. REST goes back to the basics of the HTTP protocol and does away with the need of envelopes and other heavy SOAP protocol aspects. It operates at the HTTP level with URLs, accept headers and HTTP methods.</p>

<p>A big advantage of REST services is that every browser already has the needed tools and libraries to support them. That’s why JavaScript framework developers have embraced REST as the default protocol of talking with server resources. So did the developers of the AngularJS framework.</p>

<p>For a quick introduction to REST, visit this InfoQ article: <a href="http://www.infoq.com/articles/rest-introduction">A Brief Introduction to REST</a></p>

<h2 id="rest-example">REST Example</h2>

<p>If, for example, we would like to check the stock price of the <em>IBM</em> ticker symbol we would issue a request on the stock prices web API as follows:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">curl http://example.com/api/stockprices/ibm</code></pre></div>

<p>cURL would then issue the following request:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">GET /StockPrices/IBM HTTP/1.1
Host: www.example.org
Content-Type: application/json; charset=utf-8
Content-Length: nnn</code></pre></div>

<p>The server would come back with the following response:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">Content-Length: nnn
Content-Type: application/json; charset=utf-8

{ ticker-symbol: 'IBM', 'stock-price': 34.5 }</code></pre></div>

<blockquote>
  <p>cURL is a command line tool for transferring data with URL syntax, supporting the HTTP protocol. It comes in handy as a tool for testing a web API from the command line. It is installed by default on OS X and most Linux distros. If you’re on Windows you need to install it manually. Learn more at <a href="http://curl.haxx.se">http://curl.haxx.se</a></p>
</blockquote>

<h2 id="adding-a-resource-to-your-application">Adding a resource to your application</h2>

<p>Angular has built-in support for talking with a REST web API through the <a href="https://docs.angularjs.org/api/ngResource/service/$resource">ngResource</a> module. Although you can use the <code>$resource</code> service directly in your controllers it’s better to create a custom service for each of the resources you need to communicate with. This way the configuration of the resource is done in your custom service and can be changed in one location if needed. </p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">angular</span>
        <span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'todo-app'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">'Todo'</span><span class="p">,</span> <span class="nx">Todo</span><span class="p">);</span>

    <span class="nx">Todo</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'$resource'</span><span class="p">];</span>

    <span class="kd">function</span> <span class="nx">Todo</span><span class="p">(</span><span class="nx">$resource</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">$resource</span><span class="p">(</span><span class="s1">'/api/todos'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">})();</span></code></pre></div>

<p>You can then query for a todo like this:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">Todo</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="na">id</span><span class="p">:</span><span class="mi">123</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something with the todo item
</span><span class="p">});</span></code></pre></div>

<blockquote>
  <p>Note: we’ve included a sample REST API written in node. See <a href="/appendix-1-sample-node-rest-api">Appendix 1: Sample node REST API</a></p>
</blockquote>

<h2 id="using-the-resource-in-a-state">Using the resource in a state</h2>

<p>Usually you will want to display some data on a state. You can load this data in the controller but then your view will briefly show an empty list until the data is fully loaded. AngularUI Router has a way of pre-loading data so you can prevent this from happening.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">stateSettings</span> <span class="o">=</span> <span class="p">{</span>

    <span class="cm">/* ... */</span>

    <span class="nl">state</span><span class="p">:</span> <span class="p">{</span>
        
        <span class="cm">/* ... */</span>

        <span class="c1">// Add this to your state to pre-load data before the view is processed:
</span>        <span class="nl">resolve</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">todos</span><span class="p">:</span> <span class="nx">loadTodos</span>
        <span class="p">}</span>

    <span class="p">}</span>
    
    <span class="cm">/* ... */</span>
<span class="p">};</span>

<span class="nx">loadTodos</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'todo'</span><span class="p">];</span>

<span class="kd">function</span> <span class="nx">loadTodos</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">query</span><span class="p">().</span><span class="nx">$promise</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>Now AngularUI Router will load data from the REST API before performing the state transition.</p>

<h2 id="displaying-resource-data">Displaying resource data</h2>

<p>To display the data that was loaded in the state resolve function, we need to first change the controller function. The loaded data will be injected in the controller function using the Angular dependency injection mechanism. In order to be able to use that data in our view we need to assign it to the Angular scope.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">angular</span>
        <span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'todo-app'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">'MainTodosController'</span><span class="p">,</span> <span class="nx">MainTodosController</span><span class="p">);</span>

    <span class="c1">// tell Angular we're expecting to get the todos from the state engine
</span>    <span class="nx">MainTodosController</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'todos'</span><span class="p">];</span>

    <span class="kd">function</span> <span class="nx">MainTodosController</span><span class="p">(</span><span class="nx">todos</span> <span class="cm">/* the todos loaded from the REST API */</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="c1">// assign the todos to the scope so that we can access them from within the view
</span>        <span class="nx">vm</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">todos</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">})();</span></code></pre></div>

<p>In our view we can then access the data from the <code>vm.todos</code> property.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr</span> <span class="na">ng-repeat=</span><span class="s">"todo in vm.todos"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td&gt;</span>{{ todo.title }}<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span></code></pre></div>

<nav>
  <ul class="pager">
    <li class="next"><a href="/authenticating-using-a-jwt-token">Authenticating using a JWT token <span aria-hidden="true">&rarr;</span></a></li>
  </ul>
</nav>


  </article>

</div>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  </body>
</html>